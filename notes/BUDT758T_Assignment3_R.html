<html>

<head>
<style type="text/css">
.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
<title>BUDT758T_Assignment#3_R code</title>
</head>

<body>

<p>
<br>BUDT758T_Assignment#3
<br>Topic: Performance Measure, Discriminant Anslysis, QDA, LDA
<br>Instructor: Prof. Courtney Paulson 
<br>Student: Xukun(Frank) LIU <a href='https://www.xukun-liu.com/' target='_blank'>www.xukun-liu.com </a>
<br>Details: <a href='https://drive.google.com/drive/folders/1QS4a3IDUbrTaCMJALW2Uq-T4UIg8Ewh5?usp=sharing' target='_blank'>Data/Response</a>
</p>
<div class="chunk" id="BUDT758T_Assignment_3"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">#getwd()</span>
<span class="hl std">bikeshare</span> <span class="hl kwb">=</span> <span class="hl kwd">read.csv</span><span class="hl std">(</span><span class="hl str">'bikeshare.csv'</span><span class="hl std">,</span><span class="hl kwc">header</span> <span class="hl std">=</span> <span class="hl num">TRUE</span><span class="hl std">)</span>
<span class="hl com">#View(bikeshare)</span>

<span class="hl std">dt</span> <span class="hl kwb">=</span> <span class="hl std">bikeshare</span>
<span class="hl kwd">str</span><span class="hl std">(dt)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 'data.frame':	731 obs. of  11 variables:
##  $ MONTH     : Factor w/ 12 levels &quot;APRIL&quot;,&quot;AUGUST&quot;,..: 5 5 5 5 5 5 5 5 5 5 ...
##  $ HOLIDAY   : Factor w/ 2 levels &quot;NO&quot;,&quot;YES&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ WEEKDAY   : Factor w/ 2 levels &quot;NO&quot;,&quot;YES&quot;: 1 1 2 2 2 2 2 1 1 2 ...
##  $ WEATHERSIT: int  2 2 1 1 1 1 2 2 1 1 ...
##  $ TEMP      : num  0.344 0.363 0.196 0.2 0.227 ...
##  $ ATEMP     : num  0.364 0.354 0.189 0.212 0.229 ...
##  $ HUMIDITY  : num  0.806 0.696 0.437 0.59 0.437 ...
##  $ WINDSPEED : num  0.16 0.249 0.248 0.16 0.187 ...
##  $ CASUAL    : int  331 131 120 108 82 88 148 68 54 41 ...
##  $ REGISTERED: int  654 670 1229 1454 1518 1518 1362 891 768 1280 ...
##  $ COUNT     : int  985 801 1349 1562 1600 1606 1510 959 822 1321 ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">dt</span><span class="hl opt">$</span><span class="hl std">WEATHERSIT</span> <span class="hl kwb">=</span> <span class="hl kwd">factor</span><span class="hl std">(dt</span><span class="hl opt">$</span><span class="hl std">WEATHERSIT)</span>
<span class="hl std">dt[</span><span class="hl str">'REG_85'</span><span class="hl std">]</span> <span class="hl kwb">=</span> <span class="hl kwd">ifelse</span><span class="hl std">(dt</span><span class="hl opt">$</span><span class="hl std">REGISTERED</span><span class="hl opt">/</span><span class="hl std">dt</span><span class="hl opt">$</span><span class="hl std">COUNT</span> <span class="hl opt">&gt;</span> <span class="hl num">0.85</span><span class="hl std">,</span> <span class="hl num">1</span><span class="hl std">,</span> <span class="hl num">0</span><span class="hl std">)</span>
<span class="hl kwd">str</span><span class="hl std">(dt)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 'data.frame':	731 obs. of  12 variables:
##  $ MONTH     : Factor w/ 12 levels &quot;APRIL&quot;,&quot;AUGUST&quot;,..: 5 5 5 5 5 5 5 5 5 5 ...
##  $ HOLIDAY   : Factor w/ 2 levels &quot;NO&quot;,&quot;YES&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ WEEKDAY   : Factor w/ 2 levels &quot;NO&quot;,&quot;YES&quot;: 1 1 2 2 2 2 2 1 1 2 ...
##  $ WEATHERSIT: Factor w/ 3 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;: 2 2 1 1 1 1 2 2 1 1 ...
##  $ TEMP      : num  0.344 0.363 0.196 0.2 0.227 ...
##  $ ATEMP     : num  0.364 0.354 0.189 0.212 0.229 ...
##  $ HUMIDITY  : num  0.806 0.696 0.437 0.59 0.437 ...
##  $ WINDSPEED : num  0.16 0.249 0.248 0.16 0.187 ...
##  $ CASUAL    : int  331 131 120 108 82 88 148 68 54 41 ...
##  $ REGISTERED: int  654 670 1229 1454 1518 1518 1362 891 768 1280 ...
##  $ COUNT     : int  985 801 1349 1562 1600 1606 1510 959 822 1321 ...
##  $ REG_85    : num  0 0 1 1 1 1 1 1 1 1 ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">set.seed</span><span class="hl std">(</span><span class="hl num">8726</span><span class="hl std">)</span>

<span class="hl std">train_index</span> <span class="hl kwb">=</span> <span class="hl kwd">sample</span><span class="hl std">(</span><span class="hl kwd">nrow</span><span class="hl std">(dt),</span><span class="hl num">0.75</span><span class="hl opt">*</span><span class="hl kwd">nrow</span><span class="hl std">(dt))</span>
<span class="hl std">dt_train</span> <span class="hl kwb">=</span> <span class="hl std">dt[train_index,]</span>
<span class="hl std">dt_test</span> <span class="hl kwb">=</span> <span class="hl std">dt[</span><span class="hl opt">-</span><span class="hl std">train_index,]</span>

<span class="hl kwd">attach</span><span class="hl std">(dt_train)</span>
<span class="hl std">model2</span> <span class="hl kwb">=</span> <span class="hl kwd">glm</span><span class="hl std">(</span><span class="hl kwc">formula</span> <span class="hl std">= REG_85</span> <span class="hl opt">~</span> <span class="hl std">MONTH</span><span class="hl opt">+</span><span class="hl std">HOLIDAY</span><span class="hl opt">+</span><span class="hl std">WEEKDAY</span><span class="hl opt">+</span><span class="hl std">WEATHERSIT</span><span class="hl opt">+</span>
               <span class="hl std">TEMP</span><span class="hl opt">+</span><span class="hl std">ATEMP</span><span class="hl opt">+</span><span class="hl std">HUMIDITY</span><span class="hl opt">+</span><span class="hl std">WINDSPEED,</span><span class="hl kwc">family</span> <span class="hl std">=</span> <span class="hl str">'binomial'</span><span class="hl std">)</span>
<span class="hl kwd">detach</span><span class="hl std">(dt_train)</span>
<span class="hl kwd">summary</span><span class="hl std">(model2)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
## Call:
## glm(formula = REG_85 ~ MONTH + HOLIDAY + WEEKDAY + WEATHERSIT + 
##     TEMP + ATEMP + HUMIDITY + WINDSPEED, family = &quot;binomial&quot;)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.82590  -0.54244  -0.02417   0.50250   2.09921  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)     -3.9503     1.3090  -3.018 0.002547 ** 
## MONTHAUGUST      0.5254     0.7557   0.695 0.486915    
## MONTHDECEMBER    2.2223     0.7643   2.908 0.003641 ** 
## MONTHFEBRUARY    2.4510     0.8002   3.063 0.002191 ** 
## MONTHJANUARY     3.1982     0.8613   3.713 0.000205 ***
## MONTHJULY        1.5418     0.7648   2.016 0.043800 *  
## MONTHJUNE        1.7242     0.6687   2.579 0.009919 ** 
## MONTHMARCH       0.7732     0.5872   1.317 0.187965    
## MONTHMAY         0.6242     0.5942   1.051 0.293441    
## MONTHNOVEMBER    2.1629     0.7506   2.882 0.003957 ** 
## MONTHOCTOBER     1.9372     0.6415   3.020 0.002530 ** 
## MONTHSEPTEMBER   2.4363     0.6654   3.662 0.000251 ***
## HOLIDAYYES      -4.9137     0.9633  -5.101 3.38e-07 ***
## WEEKDAYYES       4.8189     0.4934   9.766  &lt; 2e-16 ***
## WEATHERSIT2      0.4956     0.3487   1.421 0.155257    
## WEATHERSIT3     18.0546   897.2089   0.020 0.983945    
## TEMP            -3.5380     4.3823  -0.807 0.419467    
## ATEMP           -3.9438     4.4336  -0.890 0.373722    
## HUMIDITY         2.2655     1.3880   1.632 0.102630    
## WINDSPEED        4.6786     1.9355   2.417 0.015639 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 759.69  on 547  degrees of freedom
## Residual deviance: 388.07  on 528  degrees of freedom
## AIC: 428.07
## 
## Number of Fisher Scoring iterations: 16
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">cutoffs</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">0.01</span><span class="hl std">,</span><span class="hl num">0.05</span><span class="hl std">,</span><span class="hl num">0.10</span><span class="hl std">,</span><span class="hl num">0.20</span><span class="hl std">,</span><span class="hl num">0.30</span><span class="hl std">,</span><span class="hl num">0.40</span><span class="hl std">,</span><span class="hl num">0.50</span><span class="hl std">,</span><span class="hl num">0.60</span><span class="hl std">,</span><span class="hl num">0.70</span><span class="hl std">,</span><span class="hl num">0.80</span><span class="hl std">,</span><span class="hl num">0.90</span><span class="hl std">,</span><span class="hl num">0.95</span><span class="hl std">,</span><span class="hl num">0.99</span><span class="hl std">)</span>
<span class="hl std">test_pred_Prob</span> <span class="hl kwb">=</span> <span class="hl kwd">predict</span><span class="hl std">(model2,</span><span class="hl kwc">newdata</span> <span class="hl std">= dt_test,</span><span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">'response'</span><span class="hl std">)</span>
<span class="hl std">class_preds</span> <span class="hl kwb">=</span> <span class="hl kwd">vector</span><span class="hl std">(</span><span class="hl kwc">mode</span> <span class="hl std">=</span> <span class="hl str">'list'</span><span class="hl std">,</span><span class="hl kwc">length</span> <span class="hl std">=</span> <span class="hl kwd">length</span><span class="hl std">(cutoffs))</span>

<span class="hl kwa">for</span> <span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl kwd">length</span><span class="hl std">(cutoffs)) {</span>
  <span class="hl std">class_preds[i]</span> <span class="hl kwb">=</span> <span class="hl kwd">list</span><span class="hl std">(</span><span class="hl kwd">ifelse</span><span class="hl std">(test_pred_Prob</span><span class="hl opt">&gt;</span><span class="hl std">cutoffs[i],</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">0</span><span class="hl std">))</span>
<span class="hl std">}</span>
<span class="hl kwd">length</span><span class="hl std">(class_preds)</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] 13
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">store_ACC</span> <span class="hl kwb">=</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl kwd">length</span><span class="hl std">(cutoffs))</span>
<span class="hl std">store_TPR</span> <span class="hl kwb">=</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl kwd">length</span><span class="hl std">(cutoffs))</span>
<span class="hl std">store_TNR</span> <span class="hl kwb">=</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl kwd">length</span><span class="hl std">(cutoffs))</span>

<span class="hl std">confuse_test</span> <span class="hl kwb">=</span> <span class="hl kwd">table</span><span class="hl std">(dt_test</span><span class="hl opt">$</span><span class="hl std">REG_85,class_preds[[</span><span class="hl num">1</span><span class="hl std">]],</span><span class="hl kwc">dnn</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'Actual'</span><span class="hl std">,</span><span class="hl str">'Predicted'</span><span class="hl std">))</span>
<span class="hl std">confuse_test</span>
</pre></div>
<div class="output"><pre class="knitr r">##       Predicted
## Actual  0  1
##      0 18 71
##      1  0 94
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwa">for</span> <span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl kwd">length</span><span class="hl std">(class_preds)) {</span>
  <span class="hl std">confuse_test</span> <span class="hl kwb">=</span> <span class="hl kwd">table</span><span class="hl std">(dt_test</span><span class="hl opt">$</span><span class="hl std">REG_85,class_preds[[i]],</span><span class="hl kwc">dnn</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'Actual'</span><span class="hl std">,</span><span class="hl str">'Predict'</span><span class="hl std">))</span>
  <span class="hl kwd">print</span><span class="hl std">(confuse_test)</span>
  <span class="hl std">store_ACC[i]</span> <span class="hl kwb">=</span> <span class="hl std">(confuse_test[</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">]</span><span class="hl opt">+</span><span class="hl std">confuse_test[</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">])</span><span class="hl opt">/</span><span class="hl kwd">sum</span><span class="hl std">(confuse_test)</span>
  <span class="hl std">store_TPR[i]</span> <span class="hl kwb">=</span> <span class="hl std">(confuse_test[</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">])</span><span class="hl opt">/</span><span class="hl std">(confuse_test[</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">]</span><span class="hl opt">+</span><span class="hl std">confuse_test[</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">])</span>
  <span class="hl std">store_TNR[i]</span> <span class="hl kwb">=</span> <span class="hl std">(confuse_test[</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">])</span><span class="hl opt">/</span><span class="hl std">(confuse_test[</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">]</span><span class="hl opt">+</span><span class="hl std">confuse_test[</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">])</span>
<span class="hl std">}</span>
</pre></div>
<div class="output"><pre class="knitr r">##       Predict
## Actual  0  1
##      0 18 71
##      1  0 94
##       Predict
## Actual  0  1
##      0 32 57
##      1  0 94
##       Predict
## Actual  0  1
##      0 36 53
##      1  0 94
##       Predict
## Actual  0  1
##      0 51 38
##      1  3 91
##       Predict
## Actual  0  1
##      0 60 29
##      1  9 85
##       Predict
## Actual  0  1
##      0 67 22
##      1 13 81
##       Predict
## Actual  0  1
##      0 75 14
##      1 21 73
##       Predict
## Actual  0  1
##      0 77 12
##      1 25 69
##       Predict
## Actual  0  1
##      0 83  6
##      1 28 66
##       Predict
## Actual  0  1
##      0 85  4
##      1 32 62
##       Predict
## Actual  0  1
##      0 87  2
##      1 47 47
##       Predict
## Actual  0  1
##      0 87  2
##      1 59 35
##       Predict
## Actual  0  1
##      0 87  2
##      1 80 14
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">model2_measure</span> <span class="hl kwb">=</span> <span class="hl kwd">data.frame</span><span class="hl std">(cutoffs,store_ACC,store_TPR,store_TNR)</span>
<span class="hl kwd">print</span><span class="hl std">(model2_measure)</span>
</pre></div>
<div class="output"><pre class="knitr r">##    cutoffs store_ACC store_TPR store_TNR
## 1     0.01 0.6120219 1.0000000 0.2022472
## 2     0.05 0.6885246 1.0000000 0.3595506
## 3     0.10 0.7103825 1.0000000 0.4044944
## 4     0.20 0.7759563 0.9680851 0.5730337
## 5     0.30 0.7923497 0.9042553 0.6741573
## 6     0.40 0.8087432 0.8617021 0.7528090
## 7     0.50 0.8087432 0.7765957 0.8426966
## 8     0.60 0.7978142 0.7340426 0.8651685
## 9     0.70 0.8142077 0.7021277 0.9325843
## 10    0.80 0.8032787 0.6595745 0.9550562
## 11    0.90 0.7322404 0.5000000 0.9775281
## 12    0.95 0.6666667 0.3723404 0.9775281
## 13    0.99 0.5519126 0.1489362 0.9775281
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">print</span><span class="hl std">(model2_measure[model2_measure</span><span class="hl opt">$</span><span class="hl std">store_ACC</span><span class="hl opt">==</span><span class="hl kwd">max</span><span class="hl std">(model2_measure</span><span class="hl opt">$</span><span class="hl std">store_ACC),])</span>
</pre></div>
<div class="output"><pre class="knitr r">##   cutoffs store_ACC store_TPR store_TNR
## 9     0.7 0.8142077 0.7021277 0.9325843
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#ROC TPR(Sensitivity) vs. FPR(1-Specificity)</span>
<span class="hl std">x</span> <span class="hl kwb">=</span> <span class="hl num">1</span> <span class="hl opt">-</span> <span class="hl std">model2_measure</span><span class="hl opt">$</span><span class="hl std">store_TNR</span>
<span class="hl std">y</span> <span class="hl kwb">=</span> <span class="hl std">model2_measure</span><span class="hl opt">$</span><span class="hl std">store_TPR</span>
<span class="hl kwd">plot</span><span class="hl std">(x,y,</span><span class="hl kwc">ylim</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">),</span><span class="hl kwc">xlim</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">),</span><span class="hl kwc">type</span><span class="hl std">=</span><span class="hl str">'l'</span><span class="hl std">,</span><span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">'Model2 Measure ROC'</span><span class="hl std">,</span><span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">'blue'</span><span class="hl std">)</span>
<span class="hl kwd">abline</span><span class="hl std">(</span><span class="hl kwc">a</span><span class="hl std">=</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl kwc">b</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/BUDT758T_Assignment_3-1.png" title="plot of chunk BUDT758T_Assignment_3" alt="plot of chunk BUDT758T_Assignment_3" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com">#baseline</span>
<span class="hl kwd">table</span><span class="hl std">(dt_test</span><span class="hl opt">$</span><span class="hl std">REG_85)</span>
</pre></div>
<div class="output"><pre class="knitr r">## 
##  0  1 
## 89 94
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">model2_baseline</span> <span class="hl kwb">=</span> <span class="hl kwd">table</span><span class="hl std">(dt_test</span><span class="hl opt">$</span><span class="hl std">REG_85)[</span><span class="hl num">2</span><span class="hl std">]</span><span class="hl opt">/</span><span class="hl kwd">sum</span><span class="hl std">(</span><span class="hl kwd">table</span><span class="hl std">(dt_test</span><span class="hl opt">$</span><span class="hl std">REG_85))</span>
<span class="hl kwd">print</span><span class="hl std">(model2_baseline)</span>
</pre></div>
<div class="output"><pre class="knitr r">##         1 
## 0.5136612
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com"># spider</span>
<span class="hl kwd">plot</span><span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= cutoffs,model2_measure</span><span class="hl opt">$</span><span class="hl std">store_ACC,</span><span class="hl kwc">ylim</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">),</span><span class="hl kwc">type</span><span class="hl std">=</span><span class="hl str">'l'</span><span class="hl std">,</span><span class="hl kwc">main</span> <span class="hl std">=</span> <span class="hl str">'Model2 Measure Spider'</span><span class="hl std">,</span><span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">'blue'</span><span class="hl std">)</span>
<span class="hl kwd">abline</span><span class="hl std">(</span><span class="hl kwc">h</span><span class="hl std">=model2_baseline,</span><span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">'black'</span><span class="hl std">)</span>
<span class="hl kwd">lines</span><span class="hl std">(cutoffs,model2_measure</span><span class="hl opt">$</span><span class="hl std">store_TPR,</span><span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">'green'</span><span class="hl std">)</span>
<span class="hl kwd">lines</span><span class="hl std">(cutoffs,model2_measure</span><span class="hl opt">$</span><span class="hl std">store_TNR,</span><span class="hl kwc">col</span><span class="hl std">=</span><span class="hl str">'red'</span><span class="hl std">)</span>
<span class="hl kwd">legend</span><span class="hl std">(</span><span class="hl kwc">x</span><span class="hl std">=</span><span class="hl num">0.5</span><span class="hl std">,</span><span class="hl kwc">y</span><span class="hl std">=</span><span class="hl num">0.4</span><span class="hl std">,</span><span class="hl kwc">legend</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'ACC'</span><span class="hl std">,</span><span class="hl str">'TPR'</span><span class="hl std">,</span><span class="hl str">'TNR'</span><span class="hl std">,</span><span class="hl str">'Baseline'</span><span class="hl std">),</span><span class="hl kwc">col</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'blue'</span><span class="hl std">,</span><span class="hl str">'green'</span><span class="hl std">,</span><span class="hl str">'red'</span><span class="hl std">,</span><span class="hl str">'black'</span><span class="hl std">),</span><span class="hl kwc">lty</span><span class="hl std">=</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl kwc">cex</span><span class="hl std">=</span><span class="hl num">0.8</span><span class="hl std">)</span>
</pre></div>
</div><div class="rimage default"><img src="figure/BUDT758T_Assignment_3-2.png" title="plot of chunk BUDT758T_Assignment_3" alt="plot of chunk BUDT758T_Assignment_3" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com"># cutoff=0.7, cutoff=0.9</span>
<span class="hl kwd">table</span><span class="hl std">(dt_test</span><span class="hl opt">$</span><span class="hl std">REG_85,class_preds[[</span><span class="hl kwd">match</span><span class="hl std">(</span><span class="hl num">0.9</span><span class="hl std">,cutoffs)]],</span><span class="hl kwc">dnn</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'Actual'</span><span class="hl std">,</span><span class="hl str">'Predicted'</span><span class="hl std">))</span>
</pre></div>
<div class="output"><pre class="knitr r">##       Predicted
## Actual  0  1
##      0 87  2
##      1 47 47
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">model2_measure[model2_measure</span><span class="hl opt">$</span><span class="hl std">cutoffs</span> <span class="hl opt">==</span> <span class="hl num">0.7</span><span class="hl std">,]</span>
</pre></div>
<div class="output"><pre class="knitr r">##   cutoffs store_ACC store_TPR store_TNR
## 9     0.7 0.8142077 0.7021277 0.9325843
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">model2_measure[model2_measure</span><span class="hl opt">$</span><span class="hl std">cutoffs</span> <span class="hl opt">==</span> <span class="hl num">0.9</span><span class="hl std">,]</span>
</pre></div>
<div class="output"><pre class="knitr r">##    cutoffs store_ACC store_TPR store_TNR
## 11     0.9 0.7322404       0.5 0.9775281
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#lda &amp; qda</span>
<span class="hl kwd">library</span><span class="hl std">(</span><span class="hl str">'MASS'</span><span class="hl std">)</span>
<span class="hl com">#lda</span>
<span class="hl kwd">attach</span><span class="hl std">(dt_train)</span>
<span class="hl std">model3_lda</span> <span class="hl kwb">=</span> <span class="hl kwd">lda</span><span class="hl std">(</span><span class="hl kwc">formula</span> <span class="hl std">= REG_85</span> <span class="hl opt">~</span> <span class="hl std">MONTH</span><span class="hl opt">+</span><span class="hl std">HOLIDAY</span><span class="hl opt">+</span><span class="hl std">WEEKDAY</span><span class="hl opt">+</span><span class="hl std">WEATHERSIT</span><span class="hl opt">+</span>
                   <span class="hl std">TEMP</span><span class="hl opt">+</span><span class="hl std">ATEMP</span><span class="hl opt">+</span><span class="hl std">HUMIDITY</span><span class="hl opt">+</span><span class="hl std">WINDSPEED)</span>
<span class="hl kwd">detach</span><span class="hl std">(dt_train)</span>
<span class="hl std">model3_lda</span>
</pre></div>
<div class="output"><pre class="knitr r">## Call:
## lda(REG_85 ~ MONTH + HOLIDAY + WEEKDAY + WEATHERSIT + TEMP + 
##     ATEMP + HUMIDITY + WINDSPEED)
## 
## Prior probabilities of groups:
##   0   1 
## 0.5 0.5 
## 
## Group means:
##   MONTHAUGUST MONTHDECEMBER MONTHFEBRUARY MONTHJANUARY  MONTHJULY
## 0  0.14233577     0.0620438    0.03649635   0.03284672 0.12408759
## 1  0.02554745     0.1313869    0.10948905   0.14598540 0.03284672
##   MONTHJUNE MONTHMARCH   MONTHMAY MONTHNOVEMBER MONTHOCTOBER
## 0 0.1094891 0.06934307 0.10583942     0.0620438   0.06204380
## 1 0.0620438 0.08759124 0.05474453     0.1021898   0.09854015
##   MONTHSEPTEMBER HOLIDAYYES WEEKDAYYES WEATHERSIT2 WEATHERSIT3      TEMP
## 0     0.08759124 0.04379562  0.4781022   0.2700730  0.00000000 0.5616366
## 1     0.09489051 0.00729927  0.9306569   0.4233577  0.04379562 0.4272311
##       ATEMP  HUMIDITY WINDSPEED
## 0 0.5335096 0.6134567 0.1793380
## 1 0.4139717 0.6407855 0.1941724
## 
## Coefficients of linear discriminants:
##                        LD1
## MONTHAUGUST     0.01725455
## MONTHDECEMBER   0.85941603
## MONTHFEBRUARY   1.04437544
## MONTHJANUARY    1.09501079
## MONTHJULY       0.68761829
## MONTHJUNE       0.85295291
## MONTHMARCH      0.38400336
## MONTHMAY        0.35088143
## MONTHNOVEMBER   0.91728505
## MONTHOCTOBER    1.00366662
## MONTHSEPTEMBER  1.29196901
## HOLIDAYYES     -2.51112044
## WEEKDAYYES      2.29053326
## WEATHERSIT2     0.27721639
## WEATHERSIT3     0.91723810
## TEMP           -1.73200920
## ATEMP          -2.09854389
## HUMIDITY        1.19748819
## WINDSPEED       2.29470973
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">test_lda_pred</span> <span class="hl kwb">=</span> <span class="hl kwd">predict</span><span class="hl std">(model3_lda,</span><span class="hl kwc">newdata</span> <span class="hl std">= dt_test)</span>

<span class="hl kwd">str</span><span class="hl std">(test_lda_pred)</span>
</pre></div>
<div class="output"><pre class="knitr r">## List of 3
##  $ class    : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 2 2 2 1 2 2 2 2 ...
##  $ posterior: num [1:183, 1:2] 0.02986 0.00752 0.01284 0.01223 0.01996 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:183] &quot;5&quot; &quot;18&quot; &quot;19&quot; &quot;24&quot; ...
##   .. ..$ : chr [1:2] &quot;0&quot; &quot;1&quot;
##  $ x        : num [1:183, 1] 1.75 2.46 2.18 2.21 1.96 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:183] &quot;5&quot; &quot;18&quot; &quot;19&quot; &quot;24&quot; ...
##   .. ..$ : chr &quot;LD1&quot;
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">test_lda_pred</span><span class="hl opt">$</span><span class="hl std">class</span>
</pre></div>
<div class="output"><pre class="knitr r">##   [1] 1 1 1 1 1 0 1 1 1 1 1 1 1 0 1 1 0 1 1 1 1 1 1 0 0 1 1 1 1 1 1 0 0 0 0
##  [36] 0 1 0 1 0 0 1 1 0 0 0 0 1 1 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
##  [71] 0 0 0 1 1 1 0 0 1 0 1 1 1 0 1 0 1 1 1 1 0 1 1 1 1 1 1 0 0 0 1 1 0 0 1
## [106] 1 0 1 1 0 0 1 0 1 0 1 1 0 0 1 1 0 0 0 1 0 0 0 0 1 0 1 1 1 1 1 1 0 0 0
## [141] 0 0 0 0 0 0 1 1 0 1 0 1 1 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 0 1 0 1
## [176] 1 1 1 1 1 1 1 1
## Levels: 0 1
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">test_lda_pred</span><span class="hl opt">$</span><span class="hl std">posterior</span>
</pre></div>
<div class="output"><pre class="knitr r">##               0           1
## 5   0.029864217 0.970135783
## 18  0.007521831 0.992478169
## 19  0.012843411 0.987156589
## 24  0.012232180 0.987767820
## 27  0.019960689 0.980039311
## 29  0.639729603 0.360270397
## 32  0.012695624 0.987304376
## 36  0.412780023 0.587219977
## 39  0.010257792 0.989742208
## 42  0.032797197 0.967202803
## 46  0.034696761 0.965303239
## 47  0.048936246 0.951063754
## 48  0.100806283 0.899193717
## 51  0.814209854 0.185790146
## 56  0.012921058 0.987078942
## 63  0.053315358 0.946684642
## 64  0.877045551 0.122954449
## 66  0.052846948 0.947153052
## 69  0.121105451 0.878894549
## 70  0.062359147 0.937640853
## 75  0.079401944 0.920598056
## 76  0.238077726 0.761922274
## 77  0.460328324 0.539671676
## 78  0.974203970 0.025796030
## 79  0.955590773 0.044409227
## 80  0.087462727 0.912537273
## 81  0.255338549 0.744661451
## 84  0.102974296 0.897025704
## 88  0.192706244 0.807293756
## 91  0.091236635 0.908763365
## 98  0.098277646 0.901722354
## 106 0.763079936 0.236920064
## 113 0.958835060 0.041164940
## 114 0.987261814 0.012738186
## 115 0.655152541 0.344847459
## 116 0.569222117 0.430777883
## 118 0.427660620 0.572339380
## 128 0.992201070 0.007798930
## 129 0.493341650 0.506658350
## 130 0.616579623 0.383420377
## 134 0.961776579 0.038223421
## 137 0.185840873 0.814159127
## 139 0.287412958 0.712587042
## 148 0.991272822 0.008727178
## 156 0.977610722 0.022389278
## 158 0.511847644 0.488152356
## 162 0.991576724 0.008423276
## 164 0.327639528 0.672360472
## 166 0.469014659 0.530985341
## 173 0.526079969 0.473920031
## 175 0.502465934 0.497534066
## 180 0.503573237 0.496426763
## 185 0.995091237 0.004908763
## 186 0.726705829 0.273294171
## 189 0.340802129 0.659197871
## 198 0.991433446 0.008566554
## 202 0.628966767 0.371033233
## 204 0.998538473 0.001461527
## 205 0.997822212 0.002177788
## 206 0.697236604 0.302763396
## 207 0.699980210 0.300019790
## 208 0.775083737 0.224916263
## 209 0.740821852 0.259178148
## 210 0.826798592 0.173201408
## 222 0.916075726 0.083924274
## 227 0.737103034 0.262896966
## 228 0.812864845 0.187135155
## 230 0.803334678 0.196665322
## 233 0.996554235 0.003445765
## 235 0.857830894 0.142169106
## 239 0.983277534 0.016722466
## 242 0.835114186 0.164885814
## 247 0.965934206 0.034065794
## 249 0.005418348 0.994581652
## 251 0.015409459 0.984590541
## 252 0.089458375 0.910541625
## 260 0.801923033 0.198076967
## 275 0.652256961 0.347743039
## 279 0.177656172 0.822343828
## 283 0.984291522 0.015708478
## 284 0.114659893 0.885340107
## 285 0.014393873 0.985606127
## 287 0.089840933 0.910159067
## 289 0.944050752 0.055949248
## 293 0.047394924 0.952605076
## 296 0.917120268 0.082879732
## 297 0.116891052 0.883108948
## 299 0.079520880 0.920479120
## 300 0.047074841 0.952925159
## 302 0.091776135 0.908223865
## 303 0.826010650 0.173989350
## 305 0.101365098 0.898634902
## 307 0.102587217 0.897412783
## 313 0.121549505 0.878450495
## 319 0.106054084 0.893945916
## 320 0.015126488 0.984873512
## 321 0.022695733 0.977304267
## 328 0.942003728 0.057996272
## 330 0.927306677 0.072693323
## 331 0.920358013 0.079641987
## 334 0.037245672 0.962754328
## 349 0.048957979 0.951042021
## 352 0.797464120 0.202535880
## 359 0.814598313 0.185401687
## 362 0.039158216 0.960841784
## 363 0.056614107 0.943385893
## 367 0.776742684 0.223257316
## 368 0.006686072 0.993313928
## 374 0.014859208 0.985140792
## 380 0.582082041 0.417917959
## 381 0.693401322 0.306598678
## 390 0.033883329 0.966116671
## 394 0.817805890 0.182194110
## 397 0.149913557 0.850086443
## 400 0.601618530 0.398381470
## 406 0.032182487 0.967817513
## 409 0.037310458 0.962689542
## 414 0.865362904 0.134637096
## 415 0.614691561 0.385308439
## 420 0.029365299 0.970634701
## 425 0.020435755 0.979564245
## 429 0.926907220 0.073092780
## 436 0.962152195 0.037847805
## 440 0.541445207 0.458554793
## 441 0.159201448 0.840798552
## 456 0.917454687 0.082545313
## 463 0.992067335 0.007932665
## 465 0.533322557 0.466677443
## 472 0.997665993 0.002334007
## 474 0.420832940 0.579167060
## 475 0.703584541 0.296415459
## 480 0.436783520 0.563216480
## 483 0.443780331 0.556219669
## 486 0.417579596 0.582420404
## 487 0.459781025 0.540218975
## 495 0.295304731 0.704695269
## 500 0.272957345 0.727042655
## 502 0.648205514 0.351794486
## 510 0.609346445 0.390653555
## 511 0.666559543 0.333440457
## 513 0.994040336 0.005959664
## 514 0.997336259 0.002663741
## 515 0.615638297 0.384361703
## 516 0.551006502 0.448993498
## 517 0.743430936 0.256569064
## 526 0.994300476 0.005699524
## 529 0.165934526 0.834065474
## 530 0.271115792 0.728884208
## 541 0.994911719 0.005088281
## 542 0.444675106 0.555324894
## 553 0.850064634 0.149935366
## 556 0.414939860 0.585060140
## 557 0.476694353 0.523305647
## 559 0.679020783 0.320979217
## 561 0.987458553 0.012541447
## 562 0.993801930 0.006198070
## 568 0.821427180 0.178572820
## 579 0.859801624 0.140198376
## 584 0.841801112 0.158198888
## 594 0.894806905 0.105193095
## 596 0.997613801 0.002386199
## 599 0.835187753 0.164812247
## 600 0.855235262 0.144764738
## 607 0.880703081 0.119296919
## 608 0.901609600 0.098390400
## 620 0.254518430 0.745481570
## 623 0.243550227 0.756449773
## 626 0.082986559 0.917013441
## 627 0.030083973 0.969916027
## 634 0.120406021 0.879593979
## 651 0.100895752 0.899104248
## 652 0.927687849 0.072312151
## 657 0.070925876 0.929074124
## 667 0.727922431 0.272077569
## 675 0.055048083 0.944951917
## 679 0.075095305 0.924904695
## 684 0.046209323 0.953790677
## 697 0.013371703 0.986628297
## 700 0.082605251 0.917394749
## 705 0.100154339 0.899845661
## 706 0.051767187 0.948232813
## 714 0.057888282 0.942111718
## 726 0.001782963 0.998217037
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">test_lda_pred</span><span class="hl opt">$</span><span class="hl std">posterior[,</span><span class="hl num">2</span><span class="hl std">]</span>
</pre></div>
<div class="output"><pre class="knitr r">##           5          18          19          24          27          29 
## 0.970135783 0.992478169 0.987156589 0.987767820 0.980039311 0.360270397 
##          32          36          39          42          46          47 
## 0.987304376 0.587219977 0.989742208 0.967202803 0.965303239 0.951063754 
##          48          51          56          63          64          66 
## 0.899193717 0.185790146 0.987078942 0.946684642 0.122954449 0.947153052 
##          69          70          75          76          77          78 
## 0.878894549 0.937640853 0.920598056 0.761922274 0.539671676 0.025796030 
##          79          80          81          84          88          91 
## 0.044409227 0.912537273 0.744661451 0.897025704 0.807293756 0.908763365 
##          98         106         113         114         115         116 
## 0.901722354 0.236920064 0.041164940 0.012738186 0.344847459 0.430777883 
##         118         128         129         130         134         137 
## 0.572339380 0.007798930 0.506658350 0.383420377 0.038223421 0.814159127 
##         139         148         156         158         162         164 
## 0.712587042 0.008727178 0.022389278 0.488152356 0.008423276 0.672360472 
##         166         173         175         180         185         186 
## 0.530985341 0.473920031 0.497534066 0.496426763 0.004908763 0.273294171 
##         189         198         202         204         205         206 
## 0.659197871 0.008566554 0.371033233 0.001461527 0.002177788 0.302763396 
##         207         208         209         210         222         227 
## 0.300019790 0.224916263 0.259178148 0.173201408 0.083924274 0.262896966 
##         228         230         233         235         239         242 
## 0.187135155 0.196665322 0.003445765 0.142169106 0.016722466 0.164885814 
##         247         249         251         252         260         275 
## 0.034065794 0.994581652 0.984590541 0.910541625 0.198076967 0.347743039 
##         279         283         284         285         287         289 
## 0.822343828 0.015708478 0.885340107 0.985606127 0.910159067 0.055949248 
##         293         296         297         299         300         302 
## 0.952605076 0.082879732 0.883108948 0.920479120 0.952925159 0.908223865 
##         303         305         307         313         319         320 
## 0.173989350 0.898634902 0.897412783 0.878450495 0.893945916 0.984873512 
##         321         328         330         331         334         349 
## 0.977304267 0.057996272 0.072693323 0.079641987 0.962754328 0.951042021 
##         352         359         362         363         367         368 
## 0.202535880 0.185401687 0.960841784 0.943385893 0.223257316 0.993313928 
##         374         380         381         390         394         397 
## 0.985140792 0.417917959 0.306598678 0.966116671 0.182194110 0.850086443 
##         400         406         409         414         415         420 
## 0.398381470 0.967817513 0.962689542 0.134637096 0.385308439 0.970634701 
##         425         429         436         440         441         456 
## 0.979564245 0.073092780 0.037847805 0.458554793 0.840798552 0.082545313 
##         463         465         472         474         475         480 
## 0.007932665 0.466677443 0.002334007 0.579167060 0.296415459 0.563216480 
##         483         486         487         495         500         502 
## 0.556219669 0.582420404 0.540218975 0.704695269 0.727042655 0.351794486 
##         510         511         513         514         515         516 
## 0.390653555 0.333440457 0.005959664 0.002663741 0.384361703 0.448993498 
##         517         526         529         530         541         542 
## 0.256569064 0.005699524 0.834065474 0.728884208 0.005088281 0.555324894 
##         553         556         557         559         561         562 
## 0.149935366 0.585060140 0.523305647 0.320979217 0.012541447 0.006198070 
##         568         579         584         594         596         599 
## 0.178572820 0.140198376 0.158198888 0.105193095 0.002386199 0.164812247 
##         600         607         608         620         623         626 
## 0.144764738 0.119296919 0.098390400 0.745481570 0.756449773 0.917013441 
##         627         634         651         652         657         667 
## 0.969916027 0.879593979 0.899104248 0.072312151 0.929074124 0.272077569 
##         675         679         684         697         700         705 
## 0.944951917 0.924904695 0.953790677 0.986628297 0.917394749 0.899845661 
##         706         714         726 
## 0.948232813 0.942111718 0.998217037
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">cutoffs</span> <span class="hl kwb">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">0.01</span><span class="hl std">,</span><span class="hl num">0.05</span><span class="hl std">,</span><span class="hl num">0.10</span><span class="hl std">,</span><span class="hl num">0.20</span><span class="hl std">,</span><span class="hl num">0.30</span><span class="hl std">,</span><span class="hl num">0.40</span><span class="hl std">,</span><span class="hl num">0.50</span><span class="hl std">,</span><span class="hl num">0.60</span><span class="hl std">,</span><span class="hl num">0.70</span><span class="hl std">,</span><span class="hl num">0.80</span><span class="hl std">,</span><span class="hl num">0.90</span><span class="hl std">,</span><span class="hl num">0.95</span><span class="hl std">,</span><span class="hl num">0.99</span><span class="hl std">)</span>
<span class="hl std">class_preds_lda</span> <span class="hl kwb">=</span> <span class="hl kwd">vector</span><span class="hl std">(</span><span class="hl kwc">mode</span> <span class="hl std">=</span> <span class="hl str">'list'</span><span class="hl std">,</span><span class="hl kwc">length</span> <span class="hl std">=</span> <span class="hl kwd">length</span><span class="hl std">(cutoffs))</span>
<span class="hl kwa">for</span> <span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl kwd">length</span><span class="hl std">(cutoffs)) {</span>
  <span class="hl std">class_preds_lda[i]</span> <span class="hl kwb">=</span> <span class="hl kwd">list</span><span class="hl std">(</span><span class="hl kwd">ifelse</span><span class="hl std">(test_lda_pred</span><span class="hl opt">$</span><span class="hl std">posterior[,</span><span class="hl num">2</span><span class="hl std">]</span><span class="hl opt">&gt;</span><span class="hl std">cutoffs[i],</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">0</span><span class="hl std">))</span>
<span class="hl std">}</span>

<span class="hl std">store_ACC_lda</span> <span class="hl kwb">=</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl kwd">length</span><span class="hl std">(cutoffs))</span>
<span class="hl std">store_TPR_lda</span> <span class="hl kwb">=</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl kwd">length</span><span class="hl std">(cutoffs))</span>
<span class="hl std">store_TNR_lda</span> <span class="hl kwb">=</span> <span class="hl kwd">rep</span><span class="hl std">(</span><span class="hl num">0</span><span class="hl std">,</span><span class="hl kwd">length</span><span class="hl std">(cutoffs))</span>

<span class="hl std">confuse_test_lda</span> <span class="hl kwb">=</span> <span class="hl kwd">table</span><span class="hl std">(dt_test</span><span class="hl opt">$</span><span class="hl std">REG_85,class_preds_lda[[</span><span class="hl num">1</span><span class="hl std">]],</span><span class="hl kwc">dnn</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'Actual'</span><span class="hl std">,</span><span class="hl str">'Predicted'</span><span class="hl std">))</span>
<span class="hl std">confuse_test_lda</span>
</pre></div>
<div class="output"><pre class="knitr r">##       Predicted
## Actual  0  1
##      0 16 73
##      1  0 94
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwa">for</span> <span class="hl std">(i</span> <span class="hl kwa">in</span> <span class="hl num">1</span><span class="hl opt">:</span><span class="hl kwd">length</span><span class="hl std">(class_preds_lda)) {</span>
  <span class="hl std">confuse_test_lda</span> <span class="hl kwb">=</span> <span class="hl kwd">table</span><span class="hl std">(dt_test</span><span class="hl opt">$</span><span class="hl std">REG_85,class_preds_lda[[i]],</span><span class="hl kwc">dnn</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'Actual'</span><span class="hl std">,</span><span class="hl str">'Predict'</span><span class="hl std">))</span>
  <span class="hl std">store_ACC_lda[i]</span> <span class="hl kwb">=</span> <span class="hl std">(confuse_test_lda[</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">]</span><span class="hl opt">+</span><span class="hl std">confuse_test_lda[</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">])</span><span class="hl opt">/</span><span class="hl kwd">sum</span><span class="hl std">(confuse_test_lda)</span>
  <span class="hl std">store_TPR_lda[i]</span> <span class="hl kwb">=</span> <span class="hl std">(confuse_test_lda[</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">])</span><span class="hl opt">/</span><span class="hl std">(confuse_test_lda[</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">]</span><span class="hl opt">+</span><span class="hl std">confuse_test_lda[</span><span class="hl num">2</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">])</span>
  <span class="hl std">store_TNR_lda[i]</span> <span class="hl kwb">=</span> <span class="hl std">(confuse_test_lda[</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">])</span><span class="hl opt">/</span><span class="hl std">(confuse_test_lda[</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">]</span><span class="hl opt">+</span><span class="hl std">confuse_test_lda[</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">2</span><span class="hl std">])</span>
<span class="hl std">}</span>
<span class="hl std">model3_lda_measure</span> <span class="hl kwb">=</span> <span class="hl kwd">data.frame</span><span class="hl std">(cutoffs,store_ACC_lda,store_TPR_lda,store_TNR_lda)</span>

<span class="hl kwd">table</span><span class="hl std">(dt_test</span><span class="hl opt">$</span><span class="hl std">REG_85,class_preds_lda[[</span><span class="hl kwd">match</span><span class="hl std">(</span><span class="hl num">0.9</span><span class="hl std">,cutoffs)]],</span><span class="hl kwc">dnn</span><span class="hl std">=</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'Actual'</span><span class="hl std">,</span><span class="hl str">'Predicted'</span><span class="hl std">))</span>
</pre></div>
<div class="output"><pre class="knitr r">##       Predicted
## Actual  0  1
##      0 88  1
##      1 44 50
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl std">model3_lda_measure[model3_lda_measure</span><span class="hl opt">$</span><span class="hl std">cutoffs</span><span class="hl opt">==</span><span class="hl num">0.9</span><span class="hl std">,]</span>
</pre></div>
<div class="output"><pre class="knitr r">##    cutoffs store_ACC_lda store_TPR_lda store_TNR_lda
## 11     0.9     0.7540984     0.5319149      0.988764
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">#qda</span>
<span class="hl kwd">attach</span><span class="hl std">(dt_train)</span>
<span class="hl std">model3_qda</span> <span class="hl kwb">=</span> <span class="hl kwd">qda</span><span class="hl std">(</span><span class="hl kwc">formula</span> <span class="hl std">= REG_85</span> <span class="hl opt">~</span> <span class="hl std">MONTH</span><span class="hl opt">+</span><span class="hl std">HOLIDAY</span><span class="hl opt">+</span><span class="hl std">WEEKDAY</span><span class="hl opt">+</span><span class="hl std">WEATHERSIT</span><span class="hl opt">+</span>
                   <span class="hl std">TEMP</span><span class="hl opt">+</span><span class="hl std">ATEMP</span><span class="hl opt">+</span><span class="hl std">HUMIDITY</span><span class="hl opt">+</span><span class="hl std">WINDSPEED)</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in qda.default(x, grouping, ...): rank deficiency in group 0
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">detach</span><span class="hl std">(dt_train)</span>
<span class="hl std">model3_qda</span>
</pre></div>
<div class="error"><pre class="knitr r">## Error in eval(expr, envir, enclos): object 'model3_qda' not found
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">table</span><span class="hl std">(dt_train</span><span class="hl opt">$</span><span class="hl std">REG_85,dt_train</span><span class="hl opt">$</span><span class="hl std">MONTH)</span>
</pre></div>
<div class="output"><pre class="knitr r">##    
##     APRIL AUGUST DECEMBER FEBRUARY JANUARY JULY JUNE MARCH MAY NOVEMBER
##   0    29     39       17       10       9   34   30    19  29       17
##   1    15      7       36       30      40    9   17    24  15       28
##    
##     OCTOBER SEPTEMBER
##   0      17        24
##   1      27        26
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">table</span><span class="hl std">(dt_train</span><span class="hl opt">$</span><span class="hl std">REG_85,dt_train</span><span class="hl opt">$</span><span class="hl std">HOLIDAY)</span>
</pre></div>
<div class="output"><pre class="knitr r">##    
##      NO YES
##   0 262  12
##   1 272   2
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">table</span><span class="hl std">(dt_train</span><span class="hl opt">$</span><span class="hl std">REG_85,dt_train</span><span class="hl opt">$</span><span class="hl std">WEEKDAY)</span>
</pre></div>
<div class="output"><pre class="knitr r">##    
##      NO YES
##   0 143 131
##   1  19 255
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">table</span><span class="hl std">(dt_train</span><span class="hl opt">$</span><span class="hl std">REG_85,dt_train</span><span class="hl opt">$</span><span class="hl std">WEATHERSIT)</span>
</pre></div>
<div class="output"><pre class="knitr r">##    
##       1   2   3
##   0 200  74   0
##   1 146 116  12
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">attach</span><span class="hl std">(dt_train)</span>
<span class="hl std">model4_qda</span> <span class="hl kwb">=</span> <span class="hl kwd">qda</span><span class="hl std">(</span><span class="hl kwc">formula</span> <span class="hl std">= REG_85</span> <span class="hl opt">~</span> <span class="hl std">MONTH</span><span class="hl opt">+</span><span class="hl std">HOLIDAY</span><span class="hl opt">+</span><span class="hl std">WEEKDAY</span><span class="hl opt">+</span>
                   <span class="hl std">TEMP</span><span class="hl opt">+</span><span class="hl std">ATEMP</span><span class="hl opt">+</span><span class="hl std">HUMIDITY</span><span class="hl opt">+</span><span class="hl std">WINDSPEED)</span>
<span class="hl kwd">detach</span><span class="hl std">(dt_train)</span>

<span class="hl std">test_qda_pred</span> <span class="hl kwb">=</span> <span class="hl kwd">predict</span><span class="hl std">(model4_qda,</span><span class="hl kwc">newdata</span> <span class="hl std">= dt_test)</span>

<span class="hl kwd">table</span><span class="hl std">(dt_test</span><span class="hl opt">$</span><span class="hl std">REG_85,</span><span class="hl kwd">ifelse</span><span class="hl std">(test_qda_pred</span><span class="hl opt">$</span><span class="hl std">posterior[,</span><span class="hl num">2</span><span class="hl std">]</span><span class="hl opt">&gt;</span><span class="hl num">0.9</span><span class="hl std">,</span><span class="hl num">1</span><span class="hl std">,</span><span class="hl num">0</span><span class="hl std">),</span><span class="hl kwc">dnn</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">'Actual'</span><span class="hl std">,</span><span class="hl str">'Predicted'</span><span class="hl std">))</span>
</pre></div>
<div class="output"><pre class="knitr r">##       Predicted
## Actual  0  1
##      0 79 10
##      1 26 68
</pre></div>
</div></div>

</body>
</html>
